<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:tal="http://xml.zope.org/namespaces/tal">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>${project} Application</title>
<meta name="keywords" content="python web application" />
<meta name="description" content="repoze.bfg web application" />
<link href="${request.application_url}/static/css/reset-fonts-grids.css" rel="stylesheet" type="text/css" />
<link href="${request.application_url}/static/css/style.css" rel="stylesheet" type="text/css" />
<script src="${request.application_url}/static/jquery-1.3.1.js" type="text/javascript" charset="utf-8"></script>
<script src="${request.application_url}/static/jquery.selectboxes.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
  $(function(){
    $('#route').change(function(){
      selectedroute = $('#route :selected').val();
      $.get('${request.application_url}/stationlist',
    {route:selectedroute},
      function(data){
        updateStationList(data);
      })
    })
  }
  ) 

  $(function(){
    $(document).ready(function(){
      selectedroute = $('#route :selected').val();
      $.get( '${request.application_url}/stationlist',
    {route:selectedroute},
      function(data){
        updateStationList(data);
      })
    })
  }
  ) 

  function updateStationList(data){  
    $("#stationStart").removeOption(/./);          
    $("#stationStart").ajaxAddOption('${request.application_url}/stationlist',
  {route:selectedroute});
    $("#stationEnd").removeOption(/./);          
    $("#stationEnd").ajaxAddOption('${request.application_url}/stationlist',
  {sortorder:'I',route:selectedroute});
  }
</script>
</head>
<body>
<!-- start header -->
<div id="logo">
  <img src="${request.application_url}/static/images/tleave.gif" alt="tleave: Find your next train" />
</div>
<!-- end header -->
<div id="wrapper">
  <!-- start page -->
  <div id="page">
    <!-- start content -->
    <div id="content">
    </div>
    <h2> stations</h2>
    <form action="/">
      <h3>choose route</h3>
      <select id="route">
        <option tal:repeat="item routes" tal:attributes="value python: item[0]; selected python: item[0] == selectedroute" tal:content="python: item[1] "> </option>
      </select>
      <select id="stationStart">
        <option tal:repeat="item routes" tal:attributes="value python: item[0]; selected python: item[1] == stationStart" tal:content="python: item[1] "> </option>
      </select>
      <select id="stationEnd">
        <option tal:repeat="item routes" tal:attributes="value python: item[0]; selected python:item[1] == stationEnd" tal:content="python: item[1] "> </option>
      </select>
    </form>
    <table class='traintimes' py:if="len(nexttrain) > 0">
      <thead><tr><th>Leaves <span class="stationHeader" py:content="stationStart"></span></th><th>Arrives <span class="stationHeader" py:content="stationEnd"></span></th></tr></thead>
      <tbody>
        <tr tal:repeat="times in nexttrain">
          <td> <span tal:content="python: times[0]">Page text goes here.</span>
          </td><td><span tal:content="python: times[1]">Page text goes here.</span></td>
        </tr>
      </tbody>
    </table>


    <!-- end content -->
    <div style="clear: both;">&nbsp;</div>
  </div>
</div>
<!-- end page -->
</body>
</html>
