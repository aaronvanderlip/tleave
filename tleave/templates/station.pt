<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:tal="http://xml.zope.org/namespaces/tal">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>${project} Application</title>
<meta name="keywords" content="python web application" />
<meta name="description" content="repoze.bfg web application" />
<link href="${request.application_url}/static/css/reset-fonts-grids.css" rel="stylesheet" type="text/css" />
<link href="${request.application_url}/static/css/style.css" rel="stylesheet" type="text/css" />
<script src="${request.application_url}/static/jquery-1.3.1.js" type="text/javascript" charset="utf-8"></script>
<script src="${request.application_url}/static/jquery.selectboxes.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">

  var empty_request = ${len(request.params)} == 0; 



    $(function(){
      $('#route').change(function(){
        selectedroute = $('#route :selected').val();
        updateStationList(selectedroute);
      })
    }
    ) 

    //this resets the menu on page load
    $(function(){
      $(document).ready(function(){
        if(empty_request){ 
          selectedroute = $('#route :selected').val();
          updateStationList(selectedroute);
        }
      })
    })

    function updateStationList(selectedroute){  
      $("#stationStart").removeOption(/./);          
      $("#stationStart").ajaxAddOption('${request.application_url}/stationlist',
    {sortorder:'O', route:selectedroute});
      $("#stationEnd").removeOption(/./);          
      $("#stationEnd").ajaxAddOption('${request.application_url}/stationlist',
    {sortorder:'I',route:selectedroute});
    }

</script>
</head>
<body>

<!-- start header -->
<div id="logo">
  <img src="${request.application_url}/static/images/tleave.gif" alt="tleave: Find your next train" />
</div>
<!-- end header -->
<div id="wrapper">
  <!-- start page -->
  <div id="page">
    <!-- start content -->
    <div id="content">
    </div>
    <form action="/" method="get">
      <h3>choose route</h3>
      <select name="route" id="route">
        <option tal:repeat="item routes" tal:attributes="value python: item[0]; selected python: item[0] == selectedroute" tal:content="python: item[1] "> </option>
      </select>
      <br />
      <select name="stationStart" id="stationStart">
        <option tal:repeat="item stationpages" tal:attributes="value python: item.stationname; selected python: item.stationname == stationStart" tal:content="python: item.stationname"> </option>
      </select>
      <label> current stop </label>
      <br />
      <select name="stationEnd" id="stationEnd">
        <option tal:repeat="item stationpages" tal:attributes="value python: item.stationname; selected python: item.stationname == stationEnd" tal:content="python: item.stationname"> </option>
      </select>
      <label> destination </label>
      <br />
      <br />
      <input type="submit" name="form.submitted" value="show trains"/>
    </form>

    <table class='traintimes' tal:condtion="python: len(nexttrain) > 0">
      <thead tal:condition="python: len(nexttrain) >0"><tr><th>Leaves <br/> <span class="stationHeader" tal:content="stationStart"></span></th><th>Arrives <br /> <span class="stationHeader" tal:content="stationEnd"></span></th></tr></thead>
      <tbody>
        <tr tal:repeat="times in nexttrain">
          <td> <span tal:content="python: times[0]">Page text goes here.</span>
          </td><td><span tal:content="python: times[1]">Page text goes here.</span></td>
        </tr>
      </tbody>
    </table>
    <h1 tal:condition="python: len(nexttrain) is 0">No trains for seleced route</h1>
    <!-- end content -->
    <div style="clear: both;">&nbsp;</div>
  </div>
  <p> built on <a href="http://bfg.repoze.org/">repoze.bfg</a></p>
</div>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-8151787-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


<!-- end page -->
</body>
</html>
